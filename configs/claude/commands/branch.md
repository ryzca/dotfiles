---
name: branch
description: "ブランチを作成する"
---

ローカルの変更内容を分析して、適切なブランチを自動で作成してください。

以下の手順で実行してください：

1. ローカルの変更内容を分析
   - `git status` でステージ済み・未ステージの変更、新規ファイルを確認
   - `git diff` および `git diff --cached` で変更の詳細を確認
   - 変更内容から以下を判断：
     - 変更の種類（新機能追加、バグ修正、メンテナンス作業など）
     - 変更の対象（どのコンポーネント・機能に関するか）

2. ブランチ名の自動決定
   - 変更内容に基づいて、プロジェクトまたはユーザーの命名規約に従ったブランチ名を決定
   - 変更内容から目的が明確に判断できない場合のみ、ユーザーに質問する
   - 決定したブランチ名をユーザーに提示し、承認を得る

3. ベースブランチの決定
   - デフォルトブランチを特定：
     `git symbolic-ref refs/remotes/origin/HEAD | sed 's@^refs/remotes/origin/@@'`
   - デフォルトブランチにいる場合はそのまま進む
   - デフォルトブランチにいない場合はユーザーに確認：
     - 現在のブランチから作成する
     - デフォルトブランチから作成する
     - worktree（`git wb`）で作成する（未コミットの変更がある場合のみ提示）

4. ブランチの作成
   - ブランチ切り替えが必要な場合はまず `git checkout` を試み、競合時のみ `git stash` する
   - ベースブランチの最新版をフェッチ・プル
   - `git checkout -b <branch-name>` で作成
   - 作成結果を確認して報告

重要な注意事項：
  - **ブランチ名は必ずユーザーの承認を得てから作成する**
  - ローカルに変更がない場合は、その旨を伝えてユーザーに目的を質問する
